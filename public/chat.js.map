{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/chat.js","webpack:///./src/services.js"],"names":["appState","pollId","isLoggedIn","messageList","userList","error","messageUserList","document","querySelector","status","messageArea","login","logout","messages","users","errMsgs","renderLogin","show","html","innerHTML","renderMessageArea","renderLogout","renderErrors","errorMessage","renderPage","append","addEventListener","e","target","classList","contains","username","value","fetchLogIn","then","poll","err","fetchLogout","message","fetchMessages","shouldPoll","setInterval","fetchChats","chats","renderMessages","renderUsers","clearTimeout","renderChats","map","sender","userName","timeStamp","text","join","Object","values","filter","user","active","fetchLoginStatus","fetch","method","headers","Headers","body","JSON","stringify","Promise","reject","response","ok","json","result"],"mappings":"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","file":"chat.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./src/chat.js\");\n","import {\r\n    fetchLogIn,\r\n    fetchLoginStatus,\r\n    fetchChats,\r\n    fetchLogout,\r\n    fetchMessages\r\n  } from './services';\r\n\r\n\r\n  const appState = {\r\n    pollId: null,\r\n    isLoggedIn: false,\r\n    messageList: [],\r\n    userList:{},\r\n    error: '',\r\n  };\r\n\r\nconst messageUserList = document.querySelector('.message-user-list'); \r\nconst status = document.querySelector('.status');\r\nconst messageArea = document.querySelector('.new-message-info');\r\nconst login = document.querySelector('.login');\r\nconst logout = document.querySelector('.logout');\r\nconst messages = document.querySelector('.messages');\r\nconst users = document.querySelector('.users');\r\n\r\n\r\nconst errMsgs = {\r\n    'network-error': 'There was a problem connecting to the network, try again',\r\n    'bad-login': 'name should not be empty, does not contain whitespace and dog word',\r\n    'not-allowed': 'something went wrong...',\r\n    'unauthorized': \"please login with username\",\r\n    'missing-name': \"item name is missing\",\r\n    \"empty-message\":\"message should not be empty\"\r\n};\r\n\r\n\r\nfunction renderLogin(show){\r\n  const login = document.querySelector('.login');\r\n  if(show){\r\n    const html = `\r\n        <h1 class = \"homepage-title\">Login Page</h1>  \r\n        <div class = \"login-info\">\r\n            <label class = \"user-name\">Username:</label><input class = \"user\" name=\"username\" placeholder=\"Enter User name\"/>\r\n        </div>\r\n        <button class =\"to-login\" type=\"submit\">Login</button>\r\n    `\r\n    login.innerHTML = html;\r\n  }\r\n  else{\r\n    login.innerHTML = ``;\r\n  }\r\n}\r\n\r\n\r\nfunction renderMessageArea(){\r\n  const html = `\r\n          <textarea class = \"new-message\" type=\"text\"  placeholder = \"Enter an Message\"></textarea>\r\n          <button class = \"send-message\" type=\"submit\">Send</button>\r\n      `\r\n      messageArea.innerHTML = html;\r\n  \r\n  }\r\n\r\nfunction renderLogout(){\r\n  const logout = document.querySelector('.logout');\r\nconst html = `\r\n      <button class = \"to-logout\" type=\"submit\">Logout</button>\r\n    `\r\n    logout.innerHTML = html;\r\n\r\n}\r\n\r\nfunction renderErrors( errorMessage ) {\r\n  status.innerHTML = errorMessage;\r\n}\r\n\r\nfunction renderPage() {\r\n  if(!appState.isLoggedIn)  {\r\n    logout.innerHTML = '';\r\n    messageArea.innerHTML = '';\r\n    messageUserList.innerHTML = '';\r\n    renderLogin(true);\r\n  } else {\r\n    renderLogin(false);\r\n    renderLogout();\r\n    renderMessageArea();\r\n    messageUserList.append(messages)\r\n    messageUserList.append(users);\r\n    \r\n  }\r\n  renderErrors(appState.error);\r\n}\r\n\r\n\r\nlogin.addEventListener('click', (e) => {\r\n  if(e.target.classList.contains('to-login')) {\r\n  const username = document.querySelector('.user').value;\r\n  fetchLogIn(username)\r\n  .then( () => {\r\n      appState.isLoggedIn = true;\r\n      appState.error = '';\r\n      poll(true);\r\n      renderPage();\r\n  })\r\n .catch( (err) => {\r\n  if (err.error == 'not-allowed' || err.error == 'unauthorized') {\r\n    appState.isLoggedIn = false;\r\n    appState.error = errMsgs[err.error] || err.error;\r\n    poll(false);\r\n    renderPage();\r\n  }\r\n  else{\r\n    appState.isLoggedIn = false;\r\n    appState.error = errMsgs[err.error] || err.error;\r\n    renderPage();\r\n    }\r\n  });\r\n}\r\n});\r\n\r\nlogout.addEventListener('click', (e) => {\r\nif(e.target.classList.contains('to-logout')) {\r\n  fetchLogout()\r\n  .then( () => {\r\n      appState.isLoggedIn = false;\r\n      poll(false);\r\n      appState.error = '';\r\n      renderPage();\r\n  })\r\n  .catch( (err) => {\r\n    appState.isLoggedIn = false;\r\n    poll(false);\r\n    appState.error = errMsgs[err.error] || err.error;\r\n    renderPage();\r\n    });\r\n}\r\n\r\n});\r\n\r\nmessageArea.addEventListener('click', (e) => {\r\nif(e.target.classList.contains('send-message')) {\r\n  const message = document.querySelector('.new-message').value;\r\n  fetchMessages(message)\r\n  .then( () => {\r\n    appState.isLoggedIn = true;\r\n    appState.error = '';\r\n    renderPage();\r\n  })\r\n  .catch( (err) => {\r\n    if (err.error == 'not-allowed' || err.error == 'unauthorized') {\r\n      appState.isLoggedIn = false;\r\n      poll(false);\r\n      appState.error = errMsgs[err.error] || err.error;\r\n      renderPage();\r\n    }\r\n    else{\r\n      appState.isLoggedIn = true;\r\n      appState.error = errMsgs[err.error] || err.error;\r\n      renderPage();\r\n    }\r\n  });\r\n }\r\n});\r\n\r\nfunction poll(shouldPoll) {\r\n  if( shouldPoll && !appState.pollId ) {\r\n    appState.pollId = setInterval( () => {\r\n      fetchChats()\r\n      .catch( (err) => {\r\n        if (err.error == 'not-allowed' || err.error == 'unauthorized') {\r\n          appState.error = errMsgs[err.error] || err.error;\r\n          appState.isLoggedIn = false;\r\n          poll(false);\r\n          renderPage();\r\n        }\r\n        else{\r\n        appState.error = errMsgs[err.error] || err.error;\r\n        renderPage();\r\n        }\r\n      })\r\n      .then( chats => {\r\n        appState.error = '';\r\n        appState.isLoggedIn = true;\r\n        appState.messageList = chats.messageList;\r\n        appState.userList = chats.userList;\r\n        renderMessages(appState.messageList,appState.userList);\r\n        renderUsers(appState.userList);\r\n      });\r\n    }, 3000);\r\n  }\r\n  if( !shouldPoll && appState.pollId ) {\r\n    clearTimeout(appState.pollId);\r\n    appState.pollId = null;\r\n  }\r\n}\r\n\r\n  function renderChats(userList,messageList){   \r\n    renderMessages(messageList,userList);\r\n    renderUsers(userList);\r\n  }\r\n\r\n  function renderMessages( messageList,userList ) {\r\n    messages.innerHTML =  messageList.map( message => `\r\n    <li>\r\n      <div class=\"message\">\r\n        <div class=\"message-info\">\r\n            <span class=\"username\">${userList[message.sender].userName}</span>\r\n            <span class=\"timestamp\">${message.timeStamp}</span>\r\n          </div>\r\n        <div class=\"message-text\">${message.text}</div>\r\n      </div>\r\n    </li>\r\n  `).join('');\r\n  }\r\n\r\n  function renderUsers(userList ) {\r\n    users.innerHTML =  Object.values(userList).filter( user => user.active).map( user => `\r\n    <li>\r\n      <div class=\"user\">\r\n        <span class=\"username\">${user.userName}</span>\r\n      </div>\r\n    </li>\r\n  `).join('') \r\n  }\r\n  \r\n\r\n  fetchLoginStatus()\r\n  .then( () => {\r\n    appState.isLoggedIn = true;\r\n    appState.error = '';\r\n    poll(true);\r\n    renderPage();\r\n})\r\n.catch((err) => {\r\n  appState.isLoggedIn = false;\r\n  renderPage();\r\n});\r\n\r\n\r\n","export const fetchLogIn = (userName) => {\r\n  return fetch('/session', {\r\n    method: 'POST',\r\n    headers: new Headers({\r\n      'content-type': 'application/json',\r\n    }),\r\n    body: JSON.stringify({ userName }),\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({error: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return;\r\n  });\r\n};\r\n\r\nexport const fetchLoginStatus = () => {\r\n  return fetch('/session', {\r\n    method: 'GET',\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({error: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n   return;\r\n  });\r\n};\r\n\r\nexport const fetchLogout = () => {\r\n  return fetch('/session', {\r\n    method: 'DELETE',\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({error: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return;\r\n  });\r\n  \r\n};\r\n\r\nexport const fetchChats = () => {\r\n  return fetch('/chats', {\r\n    method: 'GET',\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({error: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return response.json(response);\r\n  });\r\n\r\n};\r\n\r\nexport const fetchMessages = (message) => {\r\n  return fetch('/messages', {\r\n    method: 'POST',\r\n    headers: new Headers({\r\n      'content-type': 'application/json',\r\n    }),\r\n    body: JSON.stringify({ message }),\r\n  })\r\n  .catch( () => {\r\n    return Promise.reject({error: 'network-error'});\r\n  })\r\n  .then( (response) => {\r\n    if(!response.ok) {\r\n      return response.json().then( result => Promise.reject(result) );\r\n    }\r\n    return;\r\n  });\r\n};\r\n"],"sourceRoot":""}